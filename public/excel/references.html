<div class="space-y-4">
  <h1 class="text-2xl font-bold">Cell References</h1>
  
  <div>
    <h2 class="font-bold text-lg">Why References Matter</h2>
    <p>Cell references are the addresses of cells in your spreadsheet. When you use a reference like <code class="bg-gray-200 px-1 rounded">R2</code> in a formula, Excel looks up the value in that cell. This is powerful because:</p>
    <ul class="list-disc ml-5 mt-2">
      <li>Your formulas automatically update when data changes</li>
      <li>You can copy formulas to apply them to multiple rows</li>
      <li>You can build complex calculations that reference many cells</li>
    </ul>
    <p class="mt-2">Understanding how references behave when you copy formulas is <strong>essential</strong> for efficient spreadsheet work.</p>
  </div>

  <div>
    <h2 class="font-bold text-lg">Types of References</h2>
    
    <div class="space-y-4 mt-3">
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2">
          <span class="bg-blue-500 text-white px-3 py-1 rounded font-mono">A1</span>
          <span class="font-semibold">Relative Reference</span>
        </div>
        <p>Changes when the formula is copied. If you copy a formula one row down, the reference shifts one row down too.</p>
        <div class="bg-white rounded p-3 mt-2 text-sm">
          <p><strong>Example:</strong> You write <code>=R2*S2</code> in cell V2</p>
          <p>Copy it to V3 → becomes <code>=R3*S3</code></p>
          <p>Copy it to V4 → becomes <code>=R4*S4</code></p>
          <p class="text-green-600 mt-1">✓ Use for: Row-by-row calculations that should apply to each row</p>
        </div>
      </div>

      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2">
          <span class="bg-yellow-600 text-white px-3 py-1 rounded font-mono">$A$1</span>
          <span class="font-semibold">Absolute Reference</span>
        </div>
        <p>Never changes when copied. The <code>$</code> symbol "locks" both the column letter and row number.</p>
        <div class="bg-white rounded p-3 mt-2 text-sm">
          <p><strong>Example:</strong> You write <code>=R2/$R$9995</code> in cell V2</p>
          <p>Copy it to V3 → becomes <code>=R3/$R$9995</code> (R2 changed, but $R$9995 stayed fixed)</p>
          <p>Copy it to V4 → becomes <code>=R4/$R$9995</code></p>
          <p class="text-green-600 mt-1">✓ Use for: References to fixed cells like totals, constants, or header rows</p>
        </div>
      </div>

      <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2">
          <span class="bg-purple-500 text-white px-3 py-1 rounded font-mono">$A1</span>
          <span class="font-semibold">Mixed Reference (Column Locked)</span>
        </div>
        <p>The column is locked (won't change when copied horizontally), but the row can change.</p>
        <div class="bg-white rounded p-3 mt-2 text-sm">
          <p><strong>Example:</strong> <code>=$A1*B$1</code></p>
          <p>Copy right → <code>=$A1*C$1</code> ($A stayed, B became C)</p>
          <p>Copy down → <code>=$A2*B$1</code> (1 became 2 for $A, but $1 stayed)</p>
          <p class="text-green-600 mt-1">✓ Use for: Multiplication tables, cross-reference matrices</p>
        </div>
      </div>

      <div class="bg-green-50 border border-green-200 rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2">
          <span class="bg-green-500 text-white px-3 py-1 rounded font-mono">A$1</span>
          <span class="font-semibold">Mixed Reference (Row Locked)</span>
        </div>
        <p>The row is locked (won't change when copied vertically), but the column can change.</p>
        <div class="bg-white rounded p-3 mt-2 text-sm">
          <p><strong>Example:</strong> <code>=A$1*$B1</code></p>
          <p>Copy right → <code>=B$1*$B1</code> (A became B, $B stayed)</p>
          <p>Copy down → <code>=A$1*$B2</code> ($1 stayed, 1 became 2)</p>
        </div>
      </div>
    </div>
  </div>

  <div>
    <h2 class="font-bold text-lg">The F4 Shortcut</h2>
    <p>Instead of typing <code>$</code> symbols manually, press <kbd class="bg-gray-200 px-2 py-1 rounded">F4</kbd> to cycle through reference types:</p>
    <div class="bg-gray-100 rounded-lg p-3 mt-2 font-mono text-sm">
      <div>A1 → <kbd class="bg-gray-300 px-1">F4</kbd> → $A$1 → <kbd class="bg-gray-300 px-1">F4</kbd> → A$1 → <kbd class="bg-gray-300 px-1">F4</kbd> → $A1 → <kbd class="bg-gray-300 px-1">F4</kbd> → A1</div>
    </div>
    <p class="text-sm text-gray-600 mt-2">Click on a cell reference in your formula, then press F4 to cycle through the options.</p>
  </div>

  <div>
    <h2 class="font-bold text-lg">Visual Example: Calculating % of Total</h2>
    <p class="mb-2">A common use case: calculating what percentage each row is of the total.</p>
    
    <div class="overflow-x-auto">
      <table class="text-sm border border-gray-300 bg-white">
        <thead class="bg-gray-100">
          <tr>
            <th class="border px-3 py-1">Row</th>
            <th class="border px-3 py-1">Sales (R)</th>
            <th class="border px-3 py-1">Formula in Column V</th>
            <th class="border px-3 py-1">Result</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="border px-3 py-1">2</td>
            <td class="border px-3 py-1">$261.96</td>
            <td class="border px-3 py-1 font-mono text-xs">=R2/<span class="text-red-600">$R$9995</span></td>
            <td class="border px-3 py-1">0.011%</td>
          </tr>
          <tr>
            <td class="border px-3 py-1">3</td>
            <td class="border px-3 py-1">$731.94</td>
            <td class="border px-3 py-1 font-mono text-xs">=R3/<span class="text-red-600">$R$9995</span></td>
            <td class="border px-3 py-1">0.032%</td>
          </tr>
          <tr>
            <td class="border px-3 py-1">4</td>
            <td class="border px-3 py-1">$14.62</td>
            <td class="border px-3 py-1 font-mono text-xs">=R4/<span class="text-red-600">$R$9995</span></td>
            <td class="border px-3 py-1">0.001%</td>
          </tr>
          <tr class="bg-yellow-50">
            <td class="border px-3 py-1">9995</td>
            <td class="border px-3 py-1 font-bold">$2,297,201</td>
            <td class="border px-3 py-1 font-mono text-xs">=SUM(R2:R9994)</td>
            <td class="border px-3 py-1 font-bold">Total</td>
          </tr>
        </tbody>
      </table>
    </div>
    <p class="text-sm text-gray-600 mt-2">The <span class="text-red-600 font-mono">$R$9995</span> (total) stays fixed while R2, R3, R4 change for each row.</p>
  </div>

  <div>
    <h2 class="font-bold text-lg">Referencing Other Sheets</h2>
    <p>You can reference cells from other sheets in your workbook:</p>
    <pre class="bg-gray-800 text-white p-3 rounded text-sm mt-2">=Sheet2!A1                        <span class="text-gray-400">// Cell A1 on Sheet2</span>
='Summary Sheet'!B5               <span class="text-gray-400">// Use quotes if sheet name has spaces</span>
=<span class="text-purple-400">SUM</span>(Sheet2!R:R)                  <span class="text-gray-400">// Sum entire column from another sheet</span>
=Sheet1!$A$1 + Sheet2!$A$1        <span class="text-gray-400">// Add values from two sheets</span></pre>
  </div>

  <div>
    <h2 class="font-bold text-lg">Named Ranges</h2>
    <p>Instead of remembering cell addresses, you can give ranges meaningful names:</p>
    <ol class="list-decimal ml-5 mt-2 text-sm">
      <li>Select the range (e.g., R2:R9994)</li>
      <li>Click in the Name Box (left of formula bar, shows "R2")</li>
      <li>Type a name like "SalesData" and press Enter</li>
      <li>Now use <code>=SUM(SalesData)</code> instead of <code>=SUM(R2:R9994)</code></li>
    </ol>
    <p class="text-sm text-gray-600 mt-2">Named ranges make formulas more readable and automatically work as absolute references.</p>
  </div>

  <div>
    <h2 class="font-bold text-lg">Key Intuitions</h2>
    <ul class="list-disc ml-5 space-y-1">
      <li><strong>$ locks what follows it</strong> - $A locks column, $1 locks row</li>
      <li><strong>Default is relative</strong> - references change unless you add $</li>
      <li><strong>Use absolute for totals</strong> - when dividing by a fixed cell</li>
      <li><strong>Use relative for row calculations</strong> - when the same formula applies to each row</li>
      <li><strong>F4 is your friend</strong> - fastest way to toggle $ symbols</li>
      <li><strong>Test by copying</strong> - copy your formula to another cell to verify it behaves correctly</li>
    </ul>
  </div>

  <div>
    <h2 class="font-bold text-lg">Practice Exercises</h2>
    <ol class="list-decimal ml-5 space-y-2">
      <li>In a new column, calculate each row's <strong>Sales as a percentage of total Sales</strong>. Use an absolute reference for the total. Copy the formula down and verify it works correctly.</li>
      <li>Calculate <strong>Profit Margin</strong> for each row (Profit ÷ Sales). This should use only relative references since both values are on the same row.</li>
      <li>Create a named range called "AllSales" for the Sales column. Use it in a SUM formula.</li>
      <li>Create a cell that calculates total Sales. Then reference that cell (with absolute reference) to calculate each row's % of total.</li>
      <li>Create a summary table on a new sheet that references totals from your data sheet.</li>
      <li>Build a simple multiplication table (5×5) using mixed references. Put numbers 1-5 in row 1 and column A, then write ONE formula that you can copy to fill the entire table.</li>
      <li>Calculate <strong>Price Per Unit</strong> (Sales ÷ Quantity) for each row and copy down.</li>
      <li>Calculate <strong>Profit Per Unit</strong> (Profit ÷ Quantity) for each row.</li>
    </ol>
  </div>
</div>
